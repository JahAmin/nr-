<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <!-- METADADOS E T√çTULO -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerenciador de Rebanho Leiteiro - Meu App Completo</title>

    <!-- ESTILOS -->
    <link rel="stylesheet" href="css/style.css">

    <!-- BIBLIOTECAS EXTERNAS -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>

    <!-- L√ìGICA PRINCIPAL -->
    <script src="js/app.js" defer></script>
</head>

<body>
<!-- =========================================================
     CABE√áALHO
========================================================== -->
<header>
    <h1>üêÆ Gerenciador de Rebanho Leiteiro</h1>

    <nav aria-label="Navega√ß√£o Principal">
        <ul>
            <li><a href="#dashboard"         class="nav-link active">Dashboard</a></li>
            <li><a href="#animais"          class="nav-link">Animais</a></li>
            <li><a href="#agenda"           class="nav-link">Agenda</a></li>
            <li><a href="#controle-leiteiro"class="nav-link">Controle Leiteiro</a></li>
            <li><a href="#relatorios"       class="nav-link">Relat√≥rios</a></li>
            <li><a href="#configuracoes"    class="nav-link">Configura√ß√µes</a></li>
        </ul>
    </nav>
</header>

<!-- =========================================================
     CONTE√öDO PRINCIPAL
========================================================== -->
<main>
    <!-- --------------- DASHBOARD --------------- -->
    <section id="dashboard" class="page-section active">
        <h2>üìä Dashboard - Vis√£o Geral do Rebanho</h2>
        <p>Bem-vindo(a)! Aqui voc√™ ver√° um resumo r√°pido do seu rebanho e insights importantes.</p>

        <div class="dashboard-widgets">
            <div class="widget">
                <h3>Total de Animais</h3>
                <p id="total-animais"><strong>0</strong></p>
            </div>
            <div class="widget">
                <h3>Vacas em Lacta√ß√£o</h3>
                <p id="vacas-lactacao"><strong>0</strong></p>
            </div>
            <div class="widget">
                <h3>Tarefas Pendentes</h3>
                <p id="tarefas-pendentes"><strong>0</strong></p>
            </div>

            <div class="widget alert-widget">
                <h3>üêÑ Vacas Pr√≥ximas ao Parto (Pr√≥ximos 7 dias)</h3>
                <ul id="proximos-partos-lista">
                    <li>Nenhuma vaca com parto previsto para os pr√≥ximos 7 dias.</li>
                </ul>
                <p class="small-text">Baseado na data de cobertura (+290 dias).</p>
            </div>

            <div class="widget cio-widget">
                <h3>üå∏ Vacas Pr√≥ximas ao Cio (Pr√≥ximos 30 dias)</h3>
                <ul id="proximos-cio-lista">
                    <li>Nenhuma vaca em cio previsto para os pr√≥ximos 30 dias.</li>
                </ul>
                <p class="small-text">Baseado na data do parto (+45 dias).</p>
            </div>
        </div>

        <div class="charts-container">
            <div class="chart-box">
                <h3>Produ√ß√£o Di√°ria (√∫ltimos 7 dias)</h3>
                <canvas id="producaoDiariaChart"></canvas>
            </div>
            <div class="chart-box">
                <h3>Distribui√ß√£o do Rebanho por Categoria</h3>
                <canvas id="distribuicaoRebanhoChart"></canvas>
            </div>
        </div>
    </section>

    <!-- --------------- ANIMAIS --------------- -->
    <section id="animais" class="page-section">
        <h2>üêÑ Gest√£o de Animais</h2>
        <button id="btn-novo-animal" class="btn-primary">+ Cadastrar Novo Animal</button>

        <div class="filter-controls">
            <label for="filtro-categoria">Filtrar por Categoria:</label>
            <select id="filtro-categoria">
                <option value="todos">Todos</option>
                <option value="lactante">Lactantes</option>
                <option value="seca">Secas</option>
                <option value="prenha">Prenhas</option>
                <option value="novilha">Novilhas</option>
                <option value="recria">Recrias</option>
                <option value="cria">Crias</option>
                <option value="touro">Touros</option>
                <option value="rufao">Ruf√µes</option>
                <option value="indefinida">Indefinida</option>
            </select>

            <label for="filtro-brinco">Filtrar por Brinco:</label>
            <input type="search" id="filtro-brinco" placeholder="Buscar por brinco/chip...">

            <input type="search" id="busca-animal" placeholder="Buscar por nome, ID ou ra√ßa...">
        </div>

        <div class="animal-list table-responsive">
            <h3>Lista de Animais</h3>
            <table>
                <thead>
                <tr>
                    <th>Foto</th>
                    <th>ID</th>
                    <th>Brinco</th>
                    <th>Nome/Ident.</th>
                    <th>Peso (kg)</th>
                    <th>Categoria Atual</th>
                    <th>Data Nasc.</th>
                    <th>A√ß√µes</th>
                </tr>
                </thead>
                <tbody id="animal-list-tbody"></tbody>
            </table>
        </div>

        <!-- Modal Cadastro/Edi√ß√£o -->
        <div id="modal-animal-form" class="modal" role="dialog" aria-modal="true" aria-labelledby="modal-animal-title">
            <div class="modal-content">
                <h3 id="modal-animal-title">Cadastro/Edi√ß√£o de Animal</h3>
                <form id="animal-form">
                    <label for="animal-id">ID do Animal:</label>
                    <input type="text" id="animal-id" required readonly aria-describedby="id-help-text">
                    <small id="id-help-text" class="help-text">ID gerado automaticamente e n√£o edit√°vel (configur√°vel nas configura√ß√µes).</small>

                    <label for="animal-brinco">Brinco / Identifica√ß√£o (chip):</label>
                    <input type="text" id="animal-brinco" placeholder="Ex: 12345">

                    <label for="animal-nome">Nome/Identificador:</label>
                    <input type="text" id="animal-nome" required>

                    <label for="animal-raca">Ra√ßa:</label>
                    <input type="text" id="animal-raca">

                    <label for="animal-peso">Peso (kg):</label>
                    <input type="number" id="animal-peso" step="0.1" min="0">

                    <label for="animal-data-nasc">Data de Nascimento:</label>
                    <input type="date" id="animal-data-nasc" required>

                    <label for="animal-sexo">Sexo:</label>
                    <select id="animal-sexo" required>
                        <option value="">Selecione</option>
                        <option value="femea">F√™mea</option>
                        <option value="macho">Macho</option>
                    </select>

                    <label for="animal-status-reprodutivo">Status Reprodutivo (F√™meas):</label>
                    <select id="animal-status-reprodutivo">
                        <option value="vazia">Vazia</option>
                        <option value="prenha">Prenha</option>
                        <option value="lactante">Lactante</option>
                        <option value="seca">Seca</option>
                    </select>

                    <div id="animal-data-parto-group" style="display: none;">
                        <label for="animal-data-parto">Data do √öltimo Parto (se lactante):</label>
                        <input type="date" id="animal-data-parto">
                    </div>

                    <label for="animal-num-partos">N¬∫ Partos:</label>
                    <input type="number" id="animal-num-partos" min="0" step="1">

                    <label for="animal-num-lactacoes">N¬∫ Lacta√ß√µes:</label>
                    <input type="number" id="animal-num-lactacoes" min="0" step="1">

                    <label for="animal-pai">Pai (ID):</label>
                    <select id="animal-pai"></select>

                    <label for="animal-mae">M√£e (ID):</label>
                    <select id="animal-mae"></select>

                    <label for="animal-data-cobertura">Data da √öltima Cobertura/Insemina√ß√£o (se prenha):</label>
                    <input type="date" id="animal-data-cobertura">

                    <label for="animal-observacoes">Observa√ß√µes Gerais:</label>
                    <textarea id="animal-observacoes" rows="2"></textarea>

                    <label for="animal-observacoes-clinicas">Observa√ß√µes Cl√≠nicas Estruturadas:</label>
                    <textarea id="animal-observacoes-clinicas" rows="3" placeholder="Ex: condi√ß√µes cr√¥nicas, tratamentos recentes"></textarea>

                    <!-- FOTO -->
                    <div class="photo-upload-section">
                        <label for="animal-foto">Inserir Foto (arquivo):</label>
                        <input type="file" id="animal-foto" accept="image/*" onchange="previewFoto(event)">
                        <img id="preview" src="" alt="Pr√©-visualiza√ß√£o da Foto" style="display: none;">
                        <small class="help-text">Ao carregar a foto, ela ser√° redimensionada para economia de espa√ßo.</small>
                    </div>

                    <div class="photo-capture-section">
                        <button type="button" id="open-camera-button" class="btn-info">Abrir C√¢mara</button>
                        <div class="camera-controls">
                            <label for="camera-select">C√¢mera:</label>
                            <select id="camera-select"></select>
                            <div>
                                <video id="video" width="640" height="480" autoplay></video>
                                <button type="button" id="capture-button">Capturar</button>
                                <div id="loading">Capturando imagem...</div>
                            </div>
                            <canvas id="canvas" style="display:none;"></canvas>
                        </div>
                    </div>

                    <label for="animal-foto-url">URL da Foto do Animal (ou Base64 do upload/captura):</label>
                    <input type="url" id="animal-foto-url" placeholder="Ex: http://exemplo.com/foto.jpg ou Base64">

                    <!-- VACINAS -->
                    <div class="vaccines-section">
                        <fieldset>
                            <legend><h3>Vacinas (hist√≥rico)</h3></legend>
                            <div id="vaccine-checkboxes-container"></div>
                            <small class="help-text">Adicione v√°rias datas para cada vacina. √â poss√≠vel agendar pr√≥xima aplica√ß√£o manualmente no hist√≥rico.</small>
                        </fieldset>
                    </div>

                    <!-- EVENTOS -->
                    <div class="events-section">
                        <h3>Hist√≥rico de Eventos</h3>
                        <div id="animal-events-list" class="task-list-mini"></div>
                        <button type="button" id="btn-add-event" class="btn-secondary">Adicionar Evento</button>
                    </div>

                    <div style="margin-top:12px;">
                        <button type="submit" class="btn-success">Salvar Animal</button>
                        <button type="button" class="btn-secondary close-modal-btn">Cancelar</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Modal Detalhes -->
        <div id="modal-detalhes-animal" class="modal" role="dialog" aria-modal="true" aria-labelledby="detalhes-animal-titulo">
            <div class="modal-content">
                <h3 id="detalhes-animal-titulo"></h3>
                <div id="detalhes-animal-conteudo" class="details-content"></div>
                <div id="detalhes-animal-timeline"></div>
                <button type="button" class="btn-secondary close-modal-btn">Fechar</button>
            </div>
        </div>
    </section>

    <!-- --------------- AGENDA --------------- -->
    <section id="agenda" class="page-section">
        <h2>üóìÔ∏è Agenda de Tarefas</h2>
        <button id="btn-nova-tarefa" class="btn-primary">+ Adicionar Tarefa</button>

        <div class="calendar-view">
            <h3>Calend√°rio Mensal (Simula√ß√£o)</h3>
            <div class="placeholder-calendar">
                <p>[Um calend√°rio din√¢mico seria exibido aqui]</p>
                <ul id="lista-tarefas-calendario" class="task-list-mini">
                    <li>Nenhuma tarefa agendada neste m√™s.</li>
                </ul>
            </div>
        </div>

        <div class="task-list">
            <h3>Pr√≥ximas Tarefas</h3>
            <ul id="proximas-tarefas-lista">
                <li>Nenhuma tarefa pendente.</li>
            </ul>
        </div>

        <!-- Modal Tarefa -->
        <div id="modal-tarefa-form" class="modal" role="dialog" aria-modal="true" aria-labelledby="modal-tarefa-title">
            <div class="modal-content">
                <h3 id="modal-tarefa-title">Adicionar Nova Tarefa</h3>
                <form id="tarefa-form">
                    <label for="tarefa-nome">Nome da Tarefa:</label>
                    <input type="text" id="tarefa-nome" required>

                    <label for="tarefa-data">Data:</label>
                    <input type="date" id="tarefa-data" required>

                    <label for="tarefa-hora">Hora (opcional):</label>
                    <input type="time" id="tarefa-hora">

                    <label for="tarefa-animal">Animal Envolvido (opcional):</label>
                    <select id="tarefa-animal">
                        <option value="">Nenhum</option>
                    </select>

                    <label for="tarefa-descricao">Descri√ß√£o:</label>
                    <textarea id="tarefa-descricao" rows="3"></textarea>

                    <button type="submit" class="btn-success">Salvar Tarefa</button>
                    <button type="button" class="btn-secondary close-modal-btn">Cancelar</button>
                </form>
            </div>
        </div>
    </section>

    <!-- --------------- CONTROLE LEITEIRO --------------- -->
    <section id="controle-leiteiro" class="page-section">
        <h2>ü•õ Controle Leiteiro</h2>
        <p>Acompanhe a produ√ß√£o de cada vaca em lacta√ß√£o.</p>

        <div class="leiteiro-controls">
            <div class="control-group">
                <label for="select-vaca-lactacao">Selecionar Vaca:</label>
                <select id="select-vaca-lactacao">
                    <option value="">Selecione uma vaca lactante</option>
                </select>
            </div>

            <div class="registro-leite card">
                <h3>Registrar Nova Produ√ß√£o</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label for="leite-quantidade">Quantidade (Litros):</label>
                        <input type="number" id="leite-quantidade" step="0.1" min="0" required>
                    </div>
                    <div class="form-group">
                        <label for="leite-data">Data:</label>
                        <input type="date" id="leite-data" required>
                    </div>
                    <div class="form-group">
                        <label for="leite-periodo">Per√≠odo:</label>
                        <select id="leite-periodo" required>
                            <option value="">Selecione</option>
                            <option value="manha">Manh√£</option>
                            <option value="tarde">Tarde</option>
                        </select>
                    </div>
                </div>
                <button id="btn-registrar-leite" class="btn-primary">Registrar Produ√ß√£o</button>
            </div>
        </div>

        <div class="producao-leite-historico">
            <h3>Hist√≥rico de Produ√ß√£o (Vaca Selecionada)</h3>
            <div class="table-responsive">
                <table class="producao-leite-table">
                    <thead>
                    <tr>
                        <th>Data</th>
                        <th>Per√≠odo</th>
                        <th>Quantidade (L)</th>
                        <th>A√ß√µes</th>
                    </tr>
                    </thead>
                    <tbody id="producao-leite-tbody">
                    <tr>
                        <td colspan="4">Selecione uma vaca para ver o hist√≥rico de produ√ß√£o.</td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </section>

    <!-- --------------- RELAT√ìRIOS --------------- -->
    <section id="relatorios" class="page-section">
        <h2>üìà Relat√≥rios</h2>
        <p>Gere relat√≥rios sobre o seu rebanho e produ√ß√£o.</p>

        <div class="report-controls">
            <label for="select-relatorio-tipo">Tipo de Relat√≥rio:</label>
            <select id="select-relatorio-tipo">
                <option value="">Selecione um tipo</option>
                <option value="animais-geral">Animais (Geral)</option>
                <option value="producao-mensal">Produ√ß√£o Mensal de Leite</option>
                <option value="tarefas-pendentes">Tarefas Pendentes</option>
            </select>
            <button id="btn-gerar-relatorio-pdf" class="btn-primary">Gerar Relat√≥rio (PDF)</button>
            <button id="btn-exportar-csv" class="btn-secondary">Exportar para CSV</button>
        </div>

        <div class="report-output">
            <h3>Pr√©-visualiza√ß√£o (Simula√ß√£o)</h3>
            <p>O relat√≥rio ser√° gerado em PDF ao clicar no bot√£o "Gerar Relat√≥rio".</p>
        </div>
    </section>

    <!-- --------------- CONFIGURA√á√ïES --------------- -->
    <section id="configuracoes" class="page-section">
        <h2>‚öôÔ∏è Configura√ß√µes</h2>
        <p>Ajuste as prefer√™ncias do seu aplicativo e gerencie os dados.</p>

        <form class="card" id="config-form">
            <h3>Notifica√ß√µes</h3>
            <label><input type="checkbox" id="notificacoes-push"> Receber notifica√ß√µes push</label><br>
            <label for="antecedencia-notificacao">Anteced√™ncia das notifica√ß√µes (horas):</label>
            <input type="number" id="antecedencia-notificacao" value="24" min="1"><br>

            <h3>ID e Gerenciamento de Identificadores</h3>
            <label for="config-id-prefix">Prefixo do ID (ex: AN)</label>
            <input type="text" id="config-id-prefix" value="AN"><br>
            <label for="config-id-next">Pr√≥ximo n√∫mero (inteiro)</label>
            <input type="number" id="config-id-next" value="1" min="1">
            <small class="help-text">Os novos animais usar√£o ID = prefixo + n√∫mero (padded 3 d√≠gitos).</small>

            <h3>Idioma</h3>
            <select id="idioma-app">
                <option value="pt-BR">Portugu√™s (Brasil)</option>
                <option value="en-US">English (US)</option>
            </select>

            <h3>Importar/Exportar Dados</h3>
            <button type="button" id="btn-exportar-dados" class="btn-secondary">Exportar Todos os Dados (JSON)</button><br>

            <h4>Importar JSON</h4>
            <input type="file" id="input-importar-dados" accept=".json">
            <button type="button" id="btn-importar-dados" class="btn-primary">Importar Dados</button>
            <small class="help-text">Selecione um arquivo JSON de backup para restaurar os dados.</small>

            <h4>Importar CSV (Cadastro em massa de animais)</h4>
            <input type="file" id="input-importar-csv" accept=".csv">
            <button type="button" id="btn-importar-csv" class="btn-primary">Importar CSV</button>
            <small class="help-text">
                CSV com cabe√ßalhos: id, brinco, nome, raca, peso, dataNascimento, sexo, statusReprodutivo, dataParto, dataCobertura, observacoes, fotoUrl
            </small>

            <h3>Zona de Perigo</h3>
            <button type="button" class="btn-danger" id="btn-resetar-dados">Resetar Todos os Dados</button>
            <small class="help-text">Esta a√ß√£o apagar√° todos os dados tempor√°rios do aplicativo. N√£o pode ser desfeita.</small>
        </form>
    </section>
</main>

<!-- =========================================================
     RODAP√â
========================================================== -->
<footer>
    <p>&copy; 2025 Gerenciador de Rebanho Leiteiro</p>
</footer>
</body>
</html>